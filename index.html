<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HK Driver Ultimate</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .app-view { height: calc(100vh - 200px); border: none; width: 100%; border-radius: 20px; background: white; }
        .tab-btn.active { background-color: #3b82f6; color: white; }
    </style>
</head>
<body class="bg-zinc-950 text-white overflow-hidden font-sans">
    <div class="max-w-md mx-auto h-screen flex flex-col">
        
        <header class="p-4 bg-zinc-900 flex justify-between items-center border-b border-zinc-800">
            <div id="weather-info">
                <div class="flex items-center gap-2">
                    <span id="weather-icon" class="text-2xl">ğŸŒ¡ï¸</span>
                    <span id="temp" class="text-2xl font-black">--Â°C</span>
                </div>
                <p id="weather-desc" class="text-[10px] text-zinc-400 font-bold tracking-wider">è¼‰å…¥å¤©æ°£ä¸­...</p>
            </div>
            <div class="text-right">
                <p id="warning" class="text-xs font-bold text-yellow-500"></p>
                <button onclick="location.reload()" class="text-[10px] text-zinc-600 underline">åˆ·æ–° App</button>
            </div>
        </header>

        <nav class="flex p-3 gap-2 bg-zinc-900/50">
            <button onclick="switchTab('cam')" id="btn-cam" class="tab-btn active flex-1 py-2 rounded-xl font-bold text-xs transition-all">
                ğŸ“¸ äº¤é€šå¿«æ‹
            </button>
            <button onclick="switchTab('park')" id="btn-park" class="tab-btn flex-1 py-2 rounded-xl font-bold text-xs bg-zinc-800 text-zinc-400 transition-all">
                ğŸ…¿ï¸ åœè»Šå ´ä½
            </button>
        </nav>

        <main class="flex-grow p-2">
            <div id="view-cam" class="h-full">
                <iframe src="https://www.td.gov.hk/tc/transport_in_hong_kong/its/intelligent_transport_systems_strategy_review_and_/traffic_snapshot_images/index.html" class="app-view"></iframe>
            </div>
            <div id="view-park" class="h-full hidden">
                <iframe src="https://www.td.gov.hk/tc/transport_in_hong_kong/parking/parking_vacancies/index.html" class="app-view"></iframe>
            </div>
        </main>

    </div>

    <script>
        // æŠ“å–é¦™æ¸¯å¤©æ–‡å°æ•¸æ“š
        async function fetchWeather() {
            try {
                const res = await fetch('https://data.weather.gov.hk/weatherAPI/opendata/weather.php?dataType=rhrread&lang=tc');
                const data = await res.json();
                
                // å–å¾—æº«åº¦ (ä»¥å¤©æ–‡å°ç¸½éƒ¨ç‚ºæº–)
                document.getElementById('temp').innerText = data.temperature.data[0].value + 'Â°C';
                
                // å–å¾—å¤©æ°£æè¿°
                document.getElementById('weather-desc').innerText = data.wxdesc[0] || 'å³æ™‚å¤©æ°£å ±å‘Š';

                // æŠ“å–è­¦å‘Šä¿¡è™Ÿ
                const warnRes = await fetch('https://data.weather.gov.hk/weatherAPI/opendata/weather.php?dataType=warningInfo&lang=tc');
                const warnData = await warnRes.json();
                const warnEl = document.getElementById('warning');
                if (warnData.details && warnData.details.length > 0) {
                    warnEl.innerText = 'âš ï¸ ' + warnData.details[0].subtype;
                } else {
                    warnEl.innerText = 'è·¯é¢æƒ…æ³æ­£å¸¸';
                }
            } catch (e) {
                console.error('Weather error');
            }
        }

        function switchTab(type) {
            const camView = document.getElementById('view-cam');
            const parkView = document.getElementById('view-park');
            const btnCam = document.getElementById('btn-cam');
            const btnPark = document.getElementById('btn-park');

            if (type === 'cam') {
                camView.classList.remove('hidden');
                parkView.classList.add('hidden');
                btnCam.classList.add('active', 'bg-blue-600', 'text-white');
                btnCam.classList.remove('bg-zinc-800', 'text-zinc-400');
                btnPark.classList.remove('active', 'bg-blue-600', 'text-white');
                btnPark.classList.add('bg-zinc-800', 'text-zinc-400');
            } else {
                parkView.classList.remove('hidden');
                camView.classList.add('hidden');
                btnPark.classList.add('active', 'bg-blue-600', 'text-white');
                btnPark.classList.remove('bg-zinc-800', 'text-zinc-400');
                btnCam.classList.remove('active', 'bg-blue-600', 'text-white');
                btnCam.classList.add('bg-zinc-800', 'text-zinc-400');
            }
        }

        // åˆå§‹åŒ–
        fetchWeather();
        // æ¯ 15 åˆ†é˜æ›´æ–°ä¸€æ¬¡å¤©æ°£
        setInterval(fetchWeather, 900000);
    </script>
</body>
</html>
